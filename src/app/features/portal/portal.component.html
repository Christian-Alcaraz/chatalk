<div class="bg-black-theme w-full min-h-screen grid grid-cols-12">
  <aside
    data-name="left-col"
    class="h-full col-span-3 flex-col border-r-[1.5px] border-neutral-800"
  >
    <!-- TODO: Make this a child component -->
    <header class="mt-6 text-md border-b-1 border-neutral-800 px-6 pb-6">
      <!-- TITLE -->
      <section data-name="header-title" class="grid grid-cols-12 mb-7">
        <section data-name="profile" class="col-span-8 flex items-center gap-4">
          <picture class="inline-block w-[48px] h-[48px] rounded-full bg-white">
          </picture>

          <h1 class="text-xl text-white">{{ userState.fullName }}</h1>
        </section>
        <!-- TODO: Implement NgIcon in Button Component -->
        <!-- ? May not be necessary, just make avatar clickable then popup menu??? -->
        <section class="col-span-4 place-self-end">
          <button
            class="flex w-[48px] h-[48px] items-center justify-center rounded-full bg-primary-500 text-white"
          >
            <ng-icon name="saxSetting2Outline" color="white"></ng-icon>
          </button>
        </section>
      </section>

      <!-- CTAS -->
      <section
        data-name="header-ctas"
        class="flex w-full items-center justify-between gap-4 mb-4"
      >
        <app-button
          class="w-full"
          [props]="{
            label: 'New Chat',
            size: 'lg',
            prefixIcon: 'fa-solid fa-user-plus',
          }"
        ></app-button>
        <app-button
          class="w-full"
          [props]="{
            label: 'New Group',
            size: 'lg',
            color: 'neutral',
            prefixIcon: 'fa-solid fa-users',
          }"
        ></app-button>
      </section>

      <!-- TODO: Create Searchfield Input Component -->
      <section
        data-name="search-message"
        class="flex items-center rounded-xl bg-neutral-800 py-2 px-4 gap-4"
      >
        <ng-icon name="saxSearchNormal1Outline" color="white"></ng-icon>
        <p class="text-white">Search...</p>
      </section>
    </header>
    <!-- TODO: Make this a child component -->
    <main class="flex-1">
      <h1 class="text-neutral-300 font-medium tracking-wide mx-6 my-6">
        Recent Chats
      </h1>

      <!-- For Loop scrollable -->
      <section
        #chatScrollableContainer
        class="overflow-y-auto pl-6 max-h-[calc(100vh-294px)] transition-color duration-75 ease-in-out"
        [ngClass]="{ 'border-t-[1.5px] border-neutral-800': isScrolled }"
        (scroll)="onScroll(chatScrollableContainer)"
      >
        @for (chat of recentChats; track chat.id) {
          <article
            class="flex items-center p-2 rounded-xl mb-4 transition-colors duration-250 ease-out hover:bg-neutral-900 cursor-pointer"
          >
            <picture
              class="inline-block w-[48px] h-[48px] rounded-full bg-white mr-4"
            >
            </picture>

            <section data-name="chat-info" class="flex-col">
              <h2 class="text-white">{{ chat.fullName }}</h2>
              <p class="text-neutral-400 text-sm">
                {{ chat.messageSnippet }}
                <span class="text-[10px]">{{ chat.timeDelivered }}</span>
              </p>
            </section>
          </article>
        }
      </section>
    </main>
  </aside>

  <!-- TODO: Make this a child component that connected to a state of active chat? -->
  <section data-name="right-col" class="col-span-9 flex flex-col">
    <header
      class="flex items-center border-b-[1.5px] border-neutral-800 py-6 px-10"
    >
      <picture
        class="inline-block w-[48px] h-[48px] rounded-full bg-white mr-4"
      >
      </picture>
      <h1 class="text-white text-2xl tracking-wide">Sara Doe</h1>
    </header>

    <main
      class="flex flex-col flex-1 bg-linear-[90deg,rgba(0,0,0,0.1)_0%,rgba(255,255,255,0.1)_45%,rgba(255,255,255,0.1)_50%,rgba(0,0,0,0.1)]"
    >
      <section
        class="max-h-[calc(100vh-180px)] overflow-y-auto px-10 py-6 flex flex-col gap-6"
      >
        <!-- class="max-w-[70%] bg-gray-200 text-black p-3 rounded-lg mb-2 w-fit" -->
        <!-- class="max-w-[70%] bg-blue-500 text-white p-3 rounded-lg mb-2 ml-auto w-fit" -->
        @for (message of activeChat; track message.messageId) {
          <section class="flex items-center">
            @if (message.userId !== userState.id) {
              <picture
                class="relative inline-block w-[32px] h-[32px] rounded-full bg-white self-end mr-4"
              >
              </picture>
            }
            <article
              class="flex flex-col justify-center bg-white border border-[#282524] rounded-xl px-4 py-3 max-w-[45%] w-fit"
              [ngClass]="{
                'bg-white ml-auto text-neutral-950':
                  message.userId === userState.id,
                'bg-black-theme/50 text-white': message.userId !== userState.id,
              }"
            >
              <p class="mb-2">{{ message.message }}</p>
              <small class="text-neutral-700">{{
                message.timeDelivered
              }}</small>
            </article>
          </section>
        }
      </section>

      <section
        class="border-t-[1.5px] border-neutral-800 bg-black-theme flex items-center justify-center flex-1"
      >
        <section
          class="flex items-center bg-neutral-400/10 rounded-3xl w-[95%] py-2 px-6"
        >
          <p class="text-white">Aa</p>
          <button
            class="bg-primary-500 p-[0.65rem] rounded-full flex items-center justify-center ml-auto"
          >
            <ng-icon name="saxSend2Outline" color="white"></ng-icon>
          </button>
        </section>
      </section>
    </main>
  </section>
</div>
